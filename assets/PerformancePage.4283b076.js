import{Q as P}from"./QItemLabel.93937425.js";import{p as S,r as m,x,y as k,a5 as A,a4 as w,F as V,z as r,A as d,K as t,B as c,C as l,M as f,aj as E,E as I,b4 as $,N as D,D as g,P as B}from"./index.cb6feb5d.js";import{F as h}from"./FancyToggleComponent.012b16cc.js";import{T as F,u as M,E as N,i as T,a as q,b as z,c as K}from"./installCanvasRenderer.00c0bd02.js";import{_ as O}from"./UniversalControlComponent.38c25c45.js";import{_ as Q}from"./plugin-vue_export-helper.21dcd24c.js";import"./QToggle.d7d8cd26.js";import"./option-sizes.508cc9c7.js";import"./private.use-form.246ff555.js";import"./QItemSection.f4d29192.js";import"./QItem.d7b53d1a.js";import"./QSlider.5da25664.js";import"./QSelect.a06ed3f8.js";import"./rtl.eb0210c3.js";import"./QChip.dc29df9d.js";const U={class:"row q-col-gutter-md q-pb-md"},j={class:"col-6"},H={class:"col-6"},L={class:"q-py-lg"},R={class:"row items-center"},Y={class:"col-6"},G={__name:"PerformanceChartComponent",setup(v){S(F,"dark"),M([T,q,z,K]);const s=m(null),o=m(!1),i=m(!1),n=x(),{settings:p}=k(n),y=m(0);let _;const b={xAxis:{type:"category",data:[]},yAxis:[{type:"value",name:"[f/s]",min:0},{type:"value",name:"[s]",max:.05,min:0}],legend:{textStyle:{fontSize:18},top:20,selected:{mapped:!0,max:!1,min:!1,mean:!1}},series:[{name:"fps",data:[],type:"line",emphasis:{disabled:!0}},{name:"cap",data:[],type:"line",emphasis:{disabled:!0}},{name:"render time",data:[],type:"line",emphasis:{disabled:!0},lineStyle:{type:"dashed"},yAxisIndex:1},{name:"sleep time",data:[],type:"line",emphasis:{disabled:!0},lineStyle:{type:"dashed"},yAxisIndex:1}]};async function C(){if(!s.value)return;const e=await $("/rest/performance"),a={xAxis:{data:e.time},yAxis:[{max:Math.round(Math.max(...e.fps_cap))},{}],series:[{data:e.fps},{data:e.fps_cap},{data:e.render_time},{data:e.sleep_time}]};s.value.setOption(a),y.value=e.delayed_frames.slice(-1)[0]}return A(()=>{console.log("activated"),i.value=!0}),w(()=>{console.log("deactivated"),i.value=!1}),V(()=>{i.value&&o.value&&!p.value.performance_mode?(clearInterval(_),_=setInterval(C,1e3)):clearInterval(_)}),(e,a)=>(r(),d(f,null,[t("div",U,[t("div",j,[c(h,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=u=>o.value=u),label:"Show Stats",icon:"show_chart",fancy:"",muted:""},null,8,["modelValue"])]),t("div",H,[c(h,{modelValue:l(p).performance_mode,"onUpdate:modelValue":a[1]||(a[1]=u=>l(p).performance_mode=u),callback:()=>l(n).set_settings("performance_mode"),label:"Performance Mode",icon:"rocket_launch",fancy:"",muted:""},null,8,["modelValue","callback"])])]),o.value?(r(),d(f,{key:0},[c(l(N),{ref_key:"echartPerformance",ref:s,option:b,style:{height:"500px"}},null,512),t("div",L,[t("div",R,[a[2]||(a[2]=t("div",{class:"col-6"},"Delayed Frames:",-1)),t("div",Y,E(y.value),1)])])],64)):I("",!0)],64))}};const J={class:"fancy-grid"},W={__name:"PerformanceControlsComponent",setup(v){const s=x();return(o,i)=>(r(),d("div",J,[(r(!0),d(f,null,D(l(s).meta.controls_performance,n=>(r(),g(O,{key:n.label,button:n},null,8,["button"]))),128))]))}};var X=Q(W,[["__scopeId","data-v-61fb2c52"]]);const ue={__name:"PerformancePage",setup(v){return(s,o)=>(r(),g(P,{padding:""},{default:B(()=>[c(G),c(X)]),_:1}))}};export{ue as default};
