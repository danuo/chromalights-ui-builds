import{a as h}from"./QItemLabel.93937425.js";import{Q as j}from"./QToggle.d7d8cd26.js";import{Q as w}from"./QItemSection.f4d29192.js";import{Q as p}from"./QItem.d7b53d1a.js";import{u as ee,a as ae,b as le,d as T,k as te,Q}from"./QSlider.5da25664.js";import{c as ne,e as r,r as S,w as oe,g as ue,W as ie,j as re,x as me,y as se,z as _,A as ve,D as R,P as c,B as b,a_ as N,aj as L,K as x,E as C,C as de,M as be}from"./index.cb6feb5d.js";import{Q as ce}from"./QSelect.a06ed3f8.js";import{F as xe}from"./FancyToggleComponent.012b16cc.js";const y={MIN:0,RANGE:1,MAX:2};var fe=ne({name:"QRange",props:{...ee,modelValue:{type:Object,default:()=>({min:null,max:null}),validator:l=>"min"in l&&"max"in l},dragRange:Boolean,dragOnlyRange:Boolean,leftLabelColor:String,leftLabelTextColor:String,rightLabelColor:String,rightLabelTextColor:String,leftLabelValue:[String,Number],rightLabelValue:[String,Number],leftThumbColor:String,rightThumbColor:String},emits:ae,setup(l,{emit:e}){const{proxy:{$q:V}}=re(),{state:t,methods:m}=le({updateValue:q,updatePosition:Z,getDragging:Y,formAttrs:r(()=>({type:"hidden",name:l.name,value:`${l.modelValue.min}|${l.modelValue.max}`}))}),u=S(null),f=S(0),k=S(0),a=S({min:0,max:0});function n(){a.value.min=l.modelValue.min===null?t.innerMin.value:T(l.modelValue.min,t.innerMin.value,t.innerMax.value),a.value.max=l.modelValue.max===null?t.innerMax.value:T(l.modelValue.max,t.innerMin.value,t.innerMax.value)}oe(()=>`${l.modelValue.min}|${l.modelValue.max}|${t.innerMin.value}|${t.innerMax.value}`,n),n();const z=r(()=>m.convertModelToRatio(a.value.min)),A=r(()=>m.convertModelToRatio(a.value.max)),I=r(()=>t.active.value===!0?f.value:z.value),F=r(()=>t.active.value===!0?k.value:A.value),K=r(()=>{const i={[t.positionProp.value]:`${100*I.value}%`,[t.sizeProp.value]:`${100*(F.value-I.value)}%`};return l.selectionImg!==void 0&&(i.backgroundImage=`url(${l.selectionImg}) !important`),i}),P=r(()=>{if(t.editable.value!==!0)return{};if(V.platform.is.mobile===!0)return{onClick:m.onMobileClick};const i={onMousedown:m.onActivate};return(l.dragRange===!0||l.dragOnlyRange===!0)&&Object.assign(i,{onFocus:()=>{t.focus.value="both"},onBlur:m.onBlur,onKeydown:D,onKeyup:m.onKeyup}),i});function E(i){return V.platform.is.mobile!==!0&&t.editable.value===!0&&l.dragOnlyRange!==!0?{onFocus:()=>{t.focus.value=i},onBlur:m.onBlur,onKeydown:D,onKeyup:m.onKeyup}:{}}const $=r(()=>l.dragOnlyRange!==!0?t.tabindex.value:null),X=r(()=>V.platform.is.mobile!==!0&&(l.dragRange||l.dragOnlyRange===!0)?t.tabindex.value:null),O=S(null),G=r(()=>E("min")),W=m.getThumbRenderFn({focusValue:"min",getNodeData:()=>({ref:O,key:"tmin",...G.value,tabindex:$.value}),ratio:I,label:r(()=>l.leftLabelValue!==void 0?l.leftLabelValue:a.value.min),thumbColor:r(()=>l.leftThumbColor||l.thumbColor||l.color),labelColor:r(()=>l.leftLabelColor||l.labelColor),labelTextColor:r(()=>l.leftLabelTextColor||l.labelTextColor)}),H=r(()=>E("max")),J=m.getThumbRenderFn({focusValue:"max",getNodeData:()=>({...H.value,key:"tmax",tabindex:$.value}),ratio:F,label:r(()=>l.rightLabelValue!==void 0?l.rightLabelValue:a.value.max),thumbColor:r(()=>l.rightThumbColor||l.thumbColor||l.color),labelColor:r(()=>l.rightLabelColor||l.labelColor),labelTextColor:r(()=>l.rightLabelTextColor||l.labelTextColor)});function q(i){(a.value.min!==l.modelValue.min||a.value.max!==l.modelValue.max)&&e("update:modelValue",{...a.value}),i===!0&&e("change",{...a.value})}function Y(i){const{left:o,top:d,width:s,height:g}=u.value.getBoundingClientRect(),B=l.dragOnlyRange===!0?0:l.vertical===!0?O.value.offsetHeight/(2*g):O.value.offsetWidth/(2*s),v={left:o,top:d,width:s,height:g,valueMin:a.value.min,valueMax:a.value.max,ratioMin:z.value,ratioMax:A.value},M=m.getDraggingRatio(i,v);return l.dragOnlyRange!==!0&&M<v.ratioMin+B?v.type=y.MIN:l.dragOnlyRange===!0||M<v.ratioMax-B?l.dragRange===!0||l.dragOnlyRange===!0?(v.type=y.RANGE,Object.assign(v,{offsetRatio:M,offsetModel:m.convertRatioToModel(M),rangeValue:v.valueMax-v.valueMin,rangeRatio:v.ratioMax-v.ratioMin})):v.type=v.ratioMax-M<M-v.ratioMin?y.MAX:y.MIN:v.type=y.MAX,v}function Z(i,o=t.dragging.value){let d;const s=m.getDraggingRatio(i,o),g=m.convertRatioToModel(s);switch(o.type){case y.MIN:s<=o.ratioMax?(d={minR:s,maxR:o.ratioMax,min:g,max:o.valueMax},t.focus.value="min"):(d={minR:o.ratioMax,maxR:s,min:o.valueMax,max:g},t.focus.value="max");break;case y.MAX:s>=o.ratioMin?(d={minR:o.ratioMin,maxR:s,min:o.valueMin,max:g},t.focus.value="max"):(d={minR:s,maxR:o.ratioMin,min:g,max:o.valueMin},t.focus.value="min");break;case y.RANGE:const B=s-o.offsetRatio,v=T(o.ratioMin+B,t.innerMinRatio.value,t.innerMaxRatio.value-o.rangeRatio),M=g-o.offsetModel,U=T(o.valueMin+M,t.innerMin.value,t.innerMax.value-o.rangeValue);d={minR:v,maxR:v+o.rangeRatio,min:t.roundValueFn.value(U),max:t.roundValueFn.value(U+o.rangeValue)},t.focus.value="both";break}a.value=a.value.min===null||a.value.max===null?{min:d.min||l.min,max:d.max||l.max}:{min:d.min,max:d.max},l.snap!==!0||l.step===0?(f.value=d.minR,k.value=d.maxR):(f.value=m.convertModelToRatio(a.value.min),k.value=m.convertModelToRatio(a.value.max))}function D(i){if(te.includes(i.keyCode)===!1)return;ie(i);const o=([34,33].includes(i.keyCode)?10:1)*t.keyStep.value,d=([34,37,40].includes(i.keyCode)?-1:1)*(t.isReversed.value===!0?-1:1)*(l.vertical===!0?-1:1)*o;if(t.focus.value==="both"){const s=a.value.max-a.value.min,g=T(t.roundValueFn.value(a.value.min+d),t.innerMin.value,t.innerMax.value-s);a.value={min:g,max:t.roundValueFn.value(g+s)}}else{if(t.focus.value===!1)return;{const s=t.focus.value;a.value={...a.value,[s]:T(t.roundValueFn.value(a.value[s]+d),s==="min"?t.innerMin.value:a.value.min,s==="max"?t.innerMax.value:a.value.max)}}}q()}return()=>{const i=m.getContent(K,X,P,o=>{o.push(W(),J())});return ue("div",{ref:u,class:"q-range "+t.classes.value+(l.modelValue.min===null||l.modelValue.max===null?" q-slider--no-value":""),...t.attributes.value,"aria-valuenow":l.modelValue.min+"|"+l.modelValue.max},i)}}});const ge={class:"row q-pa-md"},Me={class:"col-3"},_e={class:"row q-pa-md"},ye={class:"col-3"},Ve={class:"col-9"},Re={class:"row q-pa-md"},Ce={class:"col-12"},ke={class:"row q-pa-md"},Te={class:"col-12"},he={class:"row q-pa-md"},we={class:"col-9"},Qe={__name:"UniversalControlComponent",props:{button:Object,deviceIndex:Number},setup(l){const e=l,V=me(),{settings:t,devices:m}=se(V),u=r(()=>e.button.target=="device"?m[deviceIndex]:t);function f(k,a){e.button.target!="device"&&V.set_settings_value(k,a)}return(k,a)=>(_(),ve(be,null,[e.button.type=="toggle"?(_(),R(p,{key:0},{default:c(()=>[b(w,null,{default:c(()=>[b(h,{caption:""},{default:c(()=>[N(L(e.button.label),1)]),_:1}),x("div",ge,[x("div",Me,[b(j,{"onUpdate:modelValue":[a[0]||(a[0]=(n,z)=>f(e.button.var_name,n)),a[1]||(a[1]=n=>u.value.value[e.button.var_name]=n)],modelValue:u.value.value[e.button.var_name],size:"40px",color:"secondary"},null,8,["modelValue"])])])]),_:1})]),_:1})):C("",!0),e.button.type=="fancy_toggle"?(_(),R(xe,{key:1,modelValue:u.value.value[e.button.var_name],"onUpdate:modelValue":a[2]||(a[2]=n=>u.value.value[e.button.var_name]=n),callback:()=>de(V).set_settings(e.button.var_name),label:e.button.label,icon:e.button.icon,fancy:"",muted:""},null,8,["modelValue","callback","label","icon"])):C("",!0),e.button.type=="toggle_slider"?(_(),R(p,{key:2},{default:c(()=>[b(w,null,{default:c(()=>[b(h,{caption:""},{default:c(()=>[N(L(e.button.label),1)]),_:1}),x("div",_e,[x("div",ye,[b(j,{"onUpdate:modelValue":[a[3]||(a[3]=(n,z)=>f(e.button.var_name_toggle,n)),a[4]||(a[4]=n=>u.value.value[e.button.var_name_toggle]=n)],modelValue:u.value.value[e.button.var_name_toggle],size:"40px",color:"secondary"},null,8,["modelValue"])]),x("div",Ve,[b(Q,{onChange:a[5]||(a[5]=n=>f(e.button.var_name_slider,n)),modelValue:u.value.value[e.button.var_name_slider],"onUpdate:modelValue":a[6]||(a[6]=n=>u.value.value[e.button.var_name_slider]=n),color:"primary","selection-color":"secondary","track-size":"15px","thumb-size":"30px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":u.value.value[e.button.var_name_slider]},null,8,["modelValue","markers","min","max","step","label-value"])])])]),_:1})]),_:1})):C("",!0),e.button.type=="slider"?(_(),R(p,{key:3},{default:c(()=>[b(w,null,{default:c(()=>[b(h,{caption:""},{default:c(()=>[N(L(e.button.var_name),1)]),_:1}),x("div",Re,[x("div",Ce,[b(Q,{onChange:a[7]||(a[7]=n=>f(e.button.var_name,n)),modelValue:u.value.value[e.button.var_name],"onUpdate:modelValue":a[8]||(a[8]=n=>u.value.value[e.button.var_name]=n),color:"primary","selection-color":"secondary","track-size":"15px","thumb-size":"30px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":u.value.value[e.button.var_name]},null,8,["modelValue","markers","min","max","step","label-value"])])])]),_:1})]),_:1})):C("",!0),e.button.type=="range_slider"?(_(),R(p,{key:4},{default:c(()=>[b(w,null,{default:c(()=>[b(h,{caption:""},{default:c(()=>[N(L(e.button.var_name),1)]),_:1}),x("div",ke,[x("div",Te,[b(fe,{onChange:a[9]||(a[9]=n=>f(e.button.var_name,n)),modelValue:u.value.value[e.button.var_name],"onUpdate:modelValue":a[10]||(a[10]=n=>u.value.value[e.button.var_name]=n),color:"primary","selection-color":"secondary","track-size":"15px","thumb-size":"30px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":u.value.value[e.button.var_name]},null,8,["modelValue","markers","min","max","step","label-value"])])])]),_:1})]),_:1})):C("",!0),e.button.type=="padded_slider"?(_(),R(p,{key:5},{default:c(()=>[b(w,null,{default:c(()=>[b(h,{caption:""},{default:c(()=>[N(L(e.button.var_name),1)]),_:1}),x("div",he,[a[15]||(a[15]=x("div",{class:"col-3"},null,-1)),x("div",we,[b(Q,{onChange:a[11]||(a[11]=n=>f(e.button.var_name,n)),modelValue:u.value.value[e.button.var_name],"onUpdate:modelValue":a[12]||(a[12]=n=>u.value.value[e.button.var_name]=n),color:"primary","selection-color":"secondary","track-size":"15px","thumb-size":"30px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":u.value.value[e.button.var_name]},null,8,["modelValue","markers","min","max","step","label-value"])])])]),_:1})]),_:1})):C("",!0),e.button.type=="dropdown"?(_(),R(ce,{key:6,square:"",outlined:"","onUpdate:modelValue":[a[13]||(a[13]=n=>f(e.button.var_name,n)),a[14]||(a[14]=n=>u.value.value[e.button.var_name]=n)],modelValue:u.value.value[e.button.var_name],options:e.button.options,label:e.button.var_name,color:"secondary"},null,8,["modelValue","options","label"])):C("",!0)],64))}};export{Qe as _};
